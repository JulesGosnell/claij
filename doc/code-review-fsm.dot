digraph "code-review" {
  rankdir=TB;
  node [shape=box, style=rounded, fontname="Helvetica", fontsize=10];
  edge [fontname="Helvetica", fontsize=9];
  
  title [shape=plaintext label=<<FONT POINT-SIZE="14" COLOR="gray40">Code Review FSM with MCP Hat</FONT>>];
  { rank=same title }
  title -> "start" [style=invis];
  
  "start" [shape=doublecircle, fillcolor=lightgreen, style=filled];
  "end"   [shape=doublecircle, fillcolor=lightcoral, style=filled];

  "chairman" [label="chairman\n(llm + mcp hat)\nOrchestrates code review\nCan use MCP tools to read files"];
  "reviewer" [label="reviewer\n(llm)\nReviews code for concerns"];

  subgraph cluster_chairman_hat {
    label="Hat-generated";
    style=dashed;
    color=gray60;
    fontcolor=gray40;
    
    "chairman-mcp" [label="chairman-mcp\n(mcp-service)\nExecutes tool calls" style="rounded,dashed"];
  }

  "start" -> "chairman" [label="entry"];
  "chairman" -> "reviewer" [label="request review"];
  "reviewer" -> "chairman" [label="review results"];
  "chairman" -> "end" [label="summary"];
  
  "chairman" -> "chairman-mcp" [label="tool calls" style=dashed];
  "chairman-mcp" -> "chairman" [label="tool results" style=dashed];
}
